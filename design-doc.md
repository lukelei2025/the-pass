# æ•°å­—æ“ä½œå° (Digital Workbench) - è®¾è®¡æ–‡æ¡£

> **é¡¹ç›®ä»£å·**: Workbench
> **ç‰ˆæœ¬**: V1.0 (äº‘ç«¯å¢å¼ºç‰ˆ)
> **çŠ¶æ€**: å¼€å‘ä¸­ (Pre-Alpha)
> **æ›´æ–°æ—¥æœŸ**: 2026-02-15
> **æ ¸å¿ƒæ¶æ„**: React (Frontend) + Firebase (Auth/DB) + Cloudflare Workers (Edge)

---

## ğŸ“‹ äº§å“æ¦‚è¿°

### æ ¸å¿ƒç†å¿µï¼šä¿¡æ¯æµè½¬çš„ä¸­è½¬ç«™
æ‰“é€ ä¸€ä¸ª"ä¸ä»…ç”¨æ¥å­˜æ”¾ï¼Œæ›´æ˜¯ç”¨æ¥'æµè½¬'çš„æ•°å­—æ“ä½œå°"ã€‚å®ƒä¸æ˜¯ç»ˆç‚¹ï¼Œè€Œæ˜¯ä¿¡æ¯æµè½¬çš„ä¸­è½¬ç«™ã€‚æ‰€æœ‰è¿›å…¥è¿™é‡Œçš„å†…å®¹ï¼Œé»˜è®¤å¯¿å‘½åªæœ‰ **24-48 å°æ—¶**ï¼Œå¿…é¡»è¢«"å¤„ç†"ï¼Œå¦åˆ™å°±ä¼š"è…çƒ‚"ï¼ˆè‡ªåŠ¨å½’æ¡£æˆ–åˆ é™¤ï¼‰ã€‚

### è§£å†³çš„é—®é¢˜
| ç—›ç‚¹ | è§£å†³æ–¹æ¡ˆ |
|------|----------|
| **åªæ”¶è—ä¸çœ‹** | å¼•å…¥"è…çƒ‚æœºåˆ¶"ï¼ˆRottingï¼‰ï¼Œå€’è®¡æ—¶é€¼è¿«å†³ç­– |
| **ä¿¡æ¯æºç ´ç¢** | ç»Ÿä¸€å…¥å£ï¼Œæ”¯æŒé“¾æ¥ï¼ˆTwitter/å°çº¢ä¹¦/æ–‡ç« ï¼‰å’Œçº¯æ–‡æœ¬ |
| **åˆ†ç±»è´Ÿæ‹…é‡** | **AI è‡ªåŠ¨åˆ†ç±»** (Idea/Work/Personal/Read)ï¼Œå¹¶åœ¨åå°é»˜é»˜æ•´ç† |
| **å¤šè®¾å¤‡å‰²è£‚** | **äº‘ç«¯åŒæ­¥** (Firebase)ï¼Œæ‰‹æœºæ”¶é›†ï¼Œç”µè„‘å¤„ç† |

---

## ï¿½ï¸ ç³»ç»Ÿæ¶æ„ (Current Architecture)

é¡¹ç›®å·²ä»æ—©æœŸçš„"çº¯æœ¬åœ° MVP"æ¼”è¿›ä¸º"äº‘ç«¯ + è¾¹ç¼˜è®¡ç®—"çš„æ··åˆæ¶æ„ï¼Œä»¥æ”¯æŒè·¨è®¾å¤‡åŒæ­¥å’Œæ›´å¼ºçš„è‡ªåŠ¨åŒ–èƒ½åŠ›ã€‚

### 1. å‰ç«¯ (Client) - `app/`
- **æ¡†æ¶**: QA/React + Vite + TypeScript
- **çŠ¶æ€ç®¡ç†**: Zustand (è½»é‡çº§å…¨å±€çŠ¶æ€)
- **UI ç»„ä»¶**: Tailwind CSS + Shadcn/UI (Radix Primitives)
- **æŒä¹…åŒ–**: LocalForage (æœ¬åœ°ç¼“å­˜) + Firebase SDK (äº‘ç«¯åŒæ­¥)
- **éƒ¨ç½²**: Vercel / Firebase Hosting (PWA æ”¯æŒ)

### 2. åç«¯æœåŠ¡ (Backend Services)
#### A. æ•°æ®ä¸å­˜å– - `app/src/lib/firebase.ts`
- **Authentication**: Firebase Auth (Google ç™»å½• + Email Magic Link)ã€‚
- **Database**: Cloud Firestoreã€‚
  - **ç¦»çº¿æ”¯æŒ**: å¯ç”¨ `persistentLocalCache`ï¼Œæ— ç½‘ä¹Ÿèƒ½ç”¨ï¼Œè”ç½‘è‡ªåŠ¨åŒæ­¥ã€‚
  - **å®‰å…¨è§„åˆ™**: `firestore.rules` ç¡®ä¿ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®ã€‚

#### B. è¾¹ç¼˜è®¡ç®—ä¸çˆ¬è™« - `worker/` (Cloudflare Workers)
- **èŒè´£**: **URL è§£æä¸å…ƒæ•°æ®æŠ“å–**ã€‚
- **åŠŸèƒ½**:
  - è§£å†³è·¨åŸŸ (CORS) é—®é¢˜ã€‚
  - æ™ºèƒ½è¯†åˆ«å¹³å° (Twitter/X, Xiaohongshu, Conventional Web)ã€‚
  - æå–æ ‡é¢˜ã€æ‘˜è¦ã€ä½œè€…ä¿¡æ¯ï¼Œä¸º AI åˆ†ç±»æä¾›ä¸Šä¸‹æ–‡ã€‚
- **Tech**: Cloudflare Workers (TypeScript), Cheerio (HTML Parsing).

#### C. æ™ºèƒ½æœåŠ¡ - `functions/` (Firebase Functions)
- **èŒè´£**: **AI è‡ªåŠ¨åˆ†ç±»ä¸æ¨ç†**ã€‚
- **æ ¸å¿ƒé€»è¾‘**:
  - æ¥æ”¶å‰ç«¯/Worker ä¼ æ¥çš„å†…å®¹ã€‚
  - è°ƒç”¨å¤§æ¨¡å‹ API (GLM-4) è¿›è¡Œæ„å›¾è¯†åˆ«ã€‚
  - è¾“å‡ºç»“æ„åŒ–æ ‡ç­¾ï¼š`ideas` (çµæ„Ÿ), `work` (å·¥ä½œ), `personal` (ç”Ÿæ´»), `external` (é˜…è¯»)ã€‚
- **Trigger**: HTTPS Request (å½“å‰) / Firestore Trigger (è§„åˆ’ä¸­)ã€‚

---

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½æµç¨‹

### 1. æé€Ÿæ•è· (Smart Capture)
ç”¨æˆ·è¾“å…¥ URL æˆ– æ–‡æœ¬ -> ç³»ç»Ÿè‡ªåŠ¨åˆ¤æ–­ç±»å‹ã€‚
- **å¦‚æœæ˜¯ URL**: è°ƒç”¨ `worker` è·å–æ ‡é¢˜/æ‘˜è¦ -> å‰ç«¯å±•ç¤ºé¢„è§ˆå¡ç‰‡ã€‚
- **å¦‚æœæ˜¯ æ–‡æœ¬**: ç›´æ¥ç”Ÿæˆå¡ç‰‡ã€‚

### 2. AI é¢„å¤„ç† (AI Triage)
- å†…å®¹ç”± `functions` æäº¤ç»™ GLM-4 æ¨¡å‹ã€‚
- **Prompt ç­–ç•¥**:
  - åˆ†æè¯­æ°” (å‘½ä»¤? æ„Ÿæ…¨? æè¿°?)ã€‚
  - æå–å…³é”®è¯ ("ä¼šè®®"->Work, "ä¹°"->Personal)ã€‚
  - **è‡ªåŠ¨æ‰“æ ‡**: å½’å…¥å››è±¡é™ä¹‹ä¸€ï¼Œå‡å°‘ç”¨æˆ·æ‰‹åŠ¨æ“ä½œã€‚

### 3. è…çƒ‚æœºåˆ¶ (The Rot)
- **è§†è§‰åé¦ˆ**: å¡ç‰‡é¢œè‰²éšæ—¶é—´å˜åŒ– (ç»¿ -> é»„ -> çº¢ ->ç°)ã€‚
- **ç”Ÿå‘½å‘¨æœŸ**:
  - `New`: < 12å°æ—¶ (æ–°é²œ)
  - `Aging`: 12-24å°æ—¶ (è­¦å‘Š)
  - `Rotting`: > 24å°æ—¶ (å³å°†å½’æ¡£)
  - `Zombie`: å·²è¿‡æœŸ (ä»…åªè¯»/å¾…æ¸…ç†)

### 4. æ¯æ—¥æ¸…ç©º (Daily Flush)
- **ä»ªå¼æ„Ÿ**: æ¯å¤©è®¾å®šæ—¶é—´ï¼ˆå¦‚æ™šä¸Š10ç‚¹ï¼‰è§¦å‘ã€‚
- **åŠ¨ä½œ**: ä¸€é”® "Archive All Expired" -> ç§»å…¥å†å²åº“ (Firestore `archive` collection)ã€‚

---

## ğŸ“– ä½¿ç”¨æŒ‡å— (User Guide)

### 1. å®‰è£…ä¸è®¿é—®
Workbench æ˜¯ä¸€ä¸ª **PWA (Progressive Web App)**ï¼Œè®¾è®¡ä¸º"å®‰è£…å"ä½¿ç”¨ï¼Œä»¥è·å¾—åŸç”Ÿ App èˆ¬çš„ä½“éªŒã€‚

- **è®¿é—®åœ°å€**: `https://the-pass-45baf.web.app` (ç¤ºä¾‹)
- **ç”µè„‘ç«¯ (Chrome/Edge)**:
  1. æ‰“å¼€ç½‘ç«™ã€‚
  2. ç‚¹å‡»åœ°å€æ å³ä¾§çš„ "å®‰è£…å›¾æ ‡" (Install) æˆ– èœå• -> "å®‰è£… Workbench"ã€‚
  3. å®ƒå°†ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çª—å£è¿è¡Œï¼Œå¯ä»¥å›ºå®šåœ¨ Dock/ä»»åŠ¡æ ã€‚
- **ç§»åŠ¨ç«¯ (iOS Safari)**:
  1. åœ¨ Safari ä¸­æ‰“å¼€ç½‘ç«™ã€‚
  2. ç‚¹å‡»åº•éƒ¨ "åˆ†äº«" æŒ‰é’®ã€‚
  3. é€‰æ‹© "æ·»åŠ åˆ°ä¸»å±å¹•" (Add to Home Screen)ã€‚
  4. æ­¤æ—¶å®ƒå°±åƒä¸€ä¸ªåŸç”Ÿ Appï¼Œæ— æµè§ˆå™¨åœ°å€æ ï¼Œå…¨å±è¿è¡Œã€‚
- **ç§»åŠ¨ç«¯ (Android Chrome)**:
  1. èœå• -> "å®‰è£…åº”ç”¨" (Install App)ã€‚

### 2. æ ¸å¿ƒæ“ä½œ (Workflow)
1.  **æ”¶é›† (Dump)**: 
    - çœ‹åˆ°å¥½æ–‡ç«  -> å¤åˆ¶é“¾æ¥ -> æ‰“å¼€ Workbench -> ç²˜è´´ ->å›è½¦ã€‚
    - æƒ³åˆ°æ–°ç‚¹å­ -> æ‰“å¼€ Workbench -> è¾“å…¥æ–‡å­— -> å›è½¦ã€‚
2.  **åˆ†æµ (Triage)**:
    - ç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•åˆ†ç±» (Work/Personal/Read)ã€‚
    - ä½ å¯ä»¥åœ¨é—²æš‡æ—¶æ‹–æ‹½å¡ç‰‡åˆ°ä¸åŒè±¡é™ï¼Œæˆ–è€…ç‚¹å‡» "Done" å®Œæˆå®ƒã€‚
3.  **é˜²è… (Review)**:
    - æ¯å¤©æ£€æŸ¥ä¸€æ¬¡ã€‚é¢œè‰²å˜çº¢çš„å¡ç‰‡æ„å‘³ç€"å¿«è¿‡æœŸäº†"ã€‚
    - å¿…é¡»åšå‡ºå†³å®šï¼šç°åœ¨åšï¼Ÿè¿˜æ˜¯å½’æ¡£ï¼Ÿä¸å…è®¸"ä¸€ç›´æ”¾ç€"ã€‚

---

## ğŸ“Š æ•°æ®æ¨¡å‹ (Firestore Schema)

```typescript
interface Item {
  id: string;              // UUID
  userId: string;          // Owner
  content: string;         // åŸå§‹å†…å®¹
  type: 'text' | 'url' | 'image';
  
  // å…ƒæ•°æ® (ç”± Worker å¡«å……)
  metadata?: {
    title?: string;
    description?: string;
    siteName?: string;     // e.g., "Xiaohongshu", "Twitter"
    originalUrl?: string;
    imageUrl?: string;
  };

  // çŠ¶æ€æµè½¬
  status: 'inbox' | 'processed' | 'archived' | 'deleted';
  
  // AI åˆ†ç±»ç»“æœ (ç”± Functions å¡«å……)
  aiClassification?: {
    category: 'work' | 'personal' | 'ideas' | 'read';
    reasoning: string;     // AI çš„æ€è€ƒè¿‡ç¨‹ (CoT)
    confidence: number;
  };

  // æ—¶é—´æˆ³
  createdAt: Timestamp;
  expiresAt: Timestamp;    // Created + 24/48h
  archivedAt?: Timestamp;
}
```

---

## ï¿½ï¸ å¼€å‘è·¯çº¿å›¾ (Roadmap)

### Phase 1: æ ¸å¿ƒé—­ç¯ (Current)
- [x] å‰ç«¯æ¡†æ¶æ­å»º (React/Vite)
- [x] Firebase åŸºç¡€é›†æˆ (Auth/Firestore)
- [x] è¾¹ç¼˜çˆ¬è™« (Cloudflare Worker) åˆæ­¥å®ç°
- [x] AI åˆ†ç±»æœåŠ¡ (Firebase Functions + GLM-4)

### Phase 2: äº¤äº’ä¸ä½“éªŒ (Next Steps)
- [ ] **UI/UX å®Œå–„**: 
  - å®ç°"è…çƒ‚"çš„è§†è§‰ç‰¹æ•ˆ (Shaders/CSS Animations)ã€‚
  - ä¼˜åŒ–ç§»åŠ¨ç«¯æ‰‹åŠ¿ (Swipe to Archive)ã€‚
- [ ] **Worker å¢å¼º**: 
  - ä¼˜åŒ– Twitter/X çš„æŠ“å–æˆåŠŸç‡ (è§£å†³åçˆ¬)ã€‚
  - å¢åŠ å¯¹å…¬ä¼—å·/çŸ¥ä¹çš„è§£ææ”¯æŒã€‚
- [ ] **æ€§èƒ½ä¼˜åŒ–**:
  - å¼•å…¥ä¹è§‚æ›´æ–° (Optimistic UI)ï¼Œè®©æ“ä½œæ„Ÿè§‰"é›¶å»¶è¿Ÿ"ã€‚

### Phase 3: ç”Ÿæ€è¿æ¥
- [ ] **Export Actions**:
  - "Send to Notion" (ä¿å­˜é•¿æ–‡)
  - "Send to Todoist" (è½¬ä¸ºä»»åŠ¡)
- [ ] **Chrome Extension**: 
  - ä¸€é”®å‰ªè—å½“å‰ç½‘é¡µåˆ° Workbenchã€‚

---

## ï¿½ ç›®å½•ç»“æ„è¯´æ˜

```
/
â”œâ”€â”€ app/                  # å‰ç«¯åº”ç”¨ (Vite + React)
â”‚   â”œâ”€â”€ src/lib/firebase.ts  # æ ¸å¿ƒæ•°æ®åº“è¿æ¥
â”‚   â””â”€â”€ ...
â”œâ”€â”€ worker/               # Cloudflare Worker (çˆ¬è™«ä»£ç†)
â”‚   â”œâ”€â”€ src/index.ts         # è·¯ç”±åˆ†å‘
â”‚   â”œâ”€â”€ src/platforms/       # å„å¹³å°ç‰¹å®šæŠ“å–é€»è¾‘ (xhs, twitter...)
â”‚   â””â”€â”€ wrangler.toml        # éƒ¨ç½²é…ç½®
â”œâ”€â”€ functions/            # Firebase Cloud Functions (åç«¯é€»è¾‘)
â”‚   â”œâ”€â”€ src/index.ts         # AI åˆ†ç±»æ¥å£ (GLM-4)
â”‚   â””â”€â”€ ...
â”œâ”€â”€ firestore.rules       # æ•°æ®åº“å®‰å…¨è§„åˆ™
â””â”€â”€ design-doc.md         # æœ¬æ–‡æ¡£
```
